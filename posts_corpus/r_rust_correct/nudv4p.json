{
    "id": "nudv4p",
    "title": "New Tower guide: Building a middleware from scratch",
    "selftext": "[\"Building a middleware from scratch\"](https://github.com/tower-rs/tower/blob/master/guides/building-a-middleware-from-scratch.md) walks through how to build `Timeout` as it exists in Tower today, without taking any shortcuts.\n\nThis combined with [\"Inventing the `Service` trait\"](https://tokio.rs/blog/2021-05-14-inventing-the-service-trait) hopefully should demystify Tower.\n\n[tower-http](https://docs.rs/tower-http/0.1.0/tower_http/) has several simple middleware if you're looking for more examples. [`AddExtension`](https://github.com/tower-rs/tower-http/blob/master/tower-http/src/add_extension.rs), [`SetRequestHeader`](https://github.com/tower-rs/tower-http/blob/master/tower-http/src/set_header/request.rs) and [`SetResponseHeader`](https://github.com/tower-rs/tower-http/blob/master/tower-http/src/set_header/response.rs) are good places to start. If you want to see something that goes all-in then [`Trace`](https://github.com/tower-rs/tower-http/blob/master/tower-http/src/trace/service.rs) is probably the most complex middleware in tower-http.\n\nPlease ask if you have any questions. I really want to make Tower more accessible since its a very powerful library."
}